import{x as V,y as m,c as l,o as n,b as o,u as s,g as j,d as y,e,f as u,n as D,t as c,k as q,h as k,v as E,l as T,j as B,S as C,F as N}from"./app-CbFQf_sx.js";import{_ as R}from"./EmployeeLayout-DinDR6X8.js";import{_ as g,a as f}from"./InputError-BcXEORy4.js";import{_ as L}from"./TextInput-Ddq2mNMX.js";import{P as U}from"./PrimaryButton-DWgWx5Lq.js";import{_ as $}from"./SecondaryButton-B0GWn-nO.js";import"./ApplicationLogo-C9AT7BK-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-dbIahFAp.js";const I={class:"flex justify-between items-center"},O={class:"py-12"},z={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},P={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Y={class:"lg:col-span-1"},F={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},H={class:"p-6 space-y-4"},G={class:"bg-gray-50 p-4 rounded-lg"},J={class:"flex items-center justify-between mb-2"},K={class:"text-2xl font-bold text-blue-600"},Q={class:"text-xs text-gray-500 mt-1"},W={key:0,class:"text-xs text-red-600 mt-2"},X={class:"bg-gray-50 p-4 rounded-lg"},Z={class:"text-2xl font-bold text-red-600"},ee={class:"text-xs text-gray-500 mt-1"},te={class:"lg:col-span-2"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6"},le=["disabled"],ne={key:0,class:"mt-2 text-sm text-red-600"},re={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},oe={class:"flex items-center justify-between"},de={class:"text-lg font-bold text-blue-600"},ie={key:1,class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},ue={class:"flex items-start"},ce={class:"ml-3"},me={class:"text-sm text-gray-600 mt-1"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ye={key:0,class:"text-xs text-blue-600 mt-1"},pe={key:1,class:"text-xs text-green-600 mt-1"},ge={key:2,class:"text-xs text-orange-600 mt-1"},fe={key:2,class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},xe={class:"flex items-center justify-between"},_e={key:0,class:"mt-2 text-sm text-red-600"},be={key:3,class:"bg-red-50 border border-red-200 rounded-lg p-4"},we={class:"flex"},he={class:"ml-3"},De={class:"mt-2 text-sm text-red-700"},ke={key:0},Be={key:1},Le={key:2},Me={class:"flex items-center justify-end space-x-4"},Se={key:0},Ae={key:1},$e={__name:"Create",props:{leaveBalance:Object,employee:Object},setup(d){const x=d,a=V({leave_type:"",start_date:"",end_date:"",reason:""}),v=m(()=>{if(a.start_date&&a.end_date){const r=new Date(a.start_date),t=new Date(a.end_date),i=Math.abs(t-r);return Math.ceil(i/(1e3*60*60*24))+1}return 0}),p=m(()=>{switch(a.leave_type){case"annual":return x.leaveBalance.annual_available;case"medical":return x.leaveBalance.medical_available;case"emergency":return"No limit";default:return 0}}),b=m(()=>{switch(a.leave_type){case"annual":return x.leaveBalance.can_apply_annual;case"medical":case"emergency":return!0;default:return!1}}),w=m(()=>{const r=new Date;switch(a.leave_type){case"annual":const t=new Date;return t.setDate(r.getDate()+30),t.toISOString().split("T")[0];case"medical":return null;case"emergency":return r.toISOString().split("T")[0];default:return r.toISOString().split("T")[0]}}),M=m(()=>a.start_date?a.start_date:w.value),h=m(()=>{if(!a.start_date||!a.end_date)return!0;const r=new Date;r.setHours(0,0,0,0);const t=new Date(a.start_date);if(new Date(a.end_date)<t)return!1;switch(a.leave_type){case"annual":const _=new Date;return _.setDate(r.getDate()+30),_.setHours(0,0,0,0),t>=_;case"medical":return!0;case"emergency":return t>=r;default:return t>=r}}),S=m(()=>{if(!a.leave_type)return"";switch(a.leave_type){case"annual":const r=new Date,t=new Date;return t.setDate(r.getDate()+30),`You can only apply for annual leave from ${t.toLocaleDateString()} onwards (30 days from current date).`;case"medical":return"Medical leave can be applied for any date (past, present, or future).";case"emergency":return"Emergency leave can only be applied from today onwards.";default:return""}}),A=()=>{a.post(route("employee.leave.store"),{preserveScroll:!0})};return(r,t)=>(n(),l(N,null,[o(s(j),{title:"Apply for Leave"}),o(R,null,{header:y(()=>[e("div",I,[t[5]||(t[5]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Apply for Leave",-1)),o(s(C),{href:r.route("employee.leave.index"),class:"inline-flex items-center px-4 py-2 bg-gray-200 border border-transparent rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest hover:bg-gray-300 transition"},{default:y(()=>t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),B(" Back to Leave Requests ")])),_:1},8,["href"])])]),default:y(()=>[e("div",O,[e("div",z,[e("div",P,[e("div",Y,[e("div",F,[t[10]||(t[10]=e("div",{class:"px-6 py-4 bg-blue-50 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-blue-800"},"Your Leave Balance")],-1)),e("div",H,[e("div",G,[e("div",J,[t[6]||(t[6]=e("span",{class:"text-sm font-medium text-gray-700"},"Annual Leave",-1)),e("span",{class:D(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",d.leaveBalance.can_apply_annual?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},c(d.leaveBalance.can_apply_annual?"Eligible":"Not Eligible"),3)]),e("div",K,c(d.leaveBalance.annual_available),1),e("div",Q," Accrued: "+c(d.leaveBalance.annual_accrued)+" | Used: "+c(d.leaveBalance.annual_used),1),d.leaveBalance.can_apply_annual?u("",!0):(n(),l("div",W," Available after 30 days from visa start date "))]),e("div",X,[t[7]||(t[7]=e("div",{class:"flex items-center justify-between mb-2"},[e("span",{class:"text-sm font-medium text-gray-700"},"Medical Leave"),e("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"}," Available ")],-1)),e("div",Z,c(d.leaveBalance.medical_available),1),e("div",ee," Used: "+c(d.leaveBalance.medical_used)+"/14 days this year ",1)]),t[8]||(t[8]=e("div",{class:"bg-gray-50 p-4 rounded-lg"},[e("div",{class:"flex items-center justify-between mb-2"},[e("span",{class:"text-sm font-medium text-gray-700"},"Emergency Leave"),e("span",{class:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800"}," No Limit ")]),e("div",{class:"text-sm text-gray-600"},"Available from current date onwards")],-1)),t[9]||(t[9]=e("div",{class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},[e("h4",{class:"text-sm font-medium text-yellow-800 mb-2"},"Important Notes"),e("ul",{class:"text-xs text-yellow-700 space-y-1"},[e("li",null,"• Annual leave: 2.5 days per month from visa start"),e("li",null,"• Annual leave: Can apply 30 days from current date"),e("li",null,"• Medical leave: Maximum 14 days per year, any date allowed"),e("li",null,"• Emergency leave: No balance required, from today onwards"),e("li",null,"• All leaves require manager approval")])],-1))])])]),e("div",te,[e("div",ae,[t[21]||(t[21]=e("div",{class:"px-6 py-4 bg-gray-50 border-b border-gray-200"},[e("h3",{class:"text-lg font-medium text-gray-900"},"Leave Application Form")],-1)),e("div",se,[e("form",{onSubmit:q(A,["prevent"]),class:"space-y-6"},[e("div",null,[o(g,{for:"leave_type",value:"Leave Type"}),k(e("select",{id:"leave_type","onUpdate:modelValue":t[0]||(t[0]=i=>s(a).leave_type=i),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",required:""},[t[11]||(t[11]=e("option",{value:""},"Select Leave Type",-1)),e("option",{value:"annual",disabled:!d.leaveBalance.can_apply_annual},"Annual Leave",8,le),t[12]||(t[12]=e("option",{value:"medical"},"Medical Leave",-1)),t[13]||(t[13]=e("option",{value:"emergency"},"Emergency Leave",-1))],512),[[E,s(a).leave_type]]),o(f,{message:s(a).errors.leave_type,class:"mt-2"},null,8,["message"]),s(a).leave_type&&!b.value?(n(),l("div",ne," You are not eligible to apply for this leave type. ")):u("",!0)]),s(a).leave_type?(n(),l("div",re,[e("div",oe,[t[14]||(t[14]=e("span",{class:"text-sm font-medium text-blue-800"},"Available Balance:",-1)),e("span",de,c(p.value)+" days",1)])])):u("",!0),s(a).leave_type?(n(),l("div",ie,[e("div",ue,[t[16]||(t[16]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-blue-400 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ce,[t[15]||(t[15]=e("h4",{class:"text-sm font-medium text-gray-800"},"Date Selection Rules",-1)),e("p",me,c(S.value),1)])])])):u("",!0),e("div",ve,[e("div",null,[o(g,{for:"start_date",value:"Start Date"}),o(L,{id:"start_date",modelValue:s(a).start_date,"onUpdate:modelValue":t[1]||(t[1]=i=>s(a).start_date=i),type:"date",class:"mt-1 block w-full",min:w.value,required:""},null,8,["modelValue","min"]),o(f,{message:s(a).errors.start_date,class:"mt-2"},null,8,["message"]),s(a).leave_type==="annual"?(n(),l("div",ye," ℹ️ Annual leave can only be applied 30 days from current date ")):u("",!0),s(a).leave_type==="medical"?(n(),l("div",pe," ℹ️ Medical leave can be applied for any date ")):u("",!0),s(a).leave_type==="emergency"?(n(),l("div",ge," ℹ️ Emergency leave from today onwards only ")):u("",!0)]),e("div",null,[o(g,{for:"end_date",value:"End Date"}),o(L,{id:"end_date",modelValue:s(a).end_date,"onUpdate:modelValue":t[2]||(t[2]=i=>s(a).end_date=i),type:"date",class:"mt-1 block w-full",min:M.value,required:""},null,8,["modelValue","min"]),o(f,{message:s(a).errors.end_date,class:"mt-2"},null,8,["message"])])]),v.value>0?(n(),l("div",fe,[e("div",xe,[t[17]||(t[17]=e("span",{class:"text-sm font-medium text-gray-700"},"Total Days Requested:",-1)),e("span",{class:D(["text-lg font-bold",s(a).leave_type!=="emergency"&&v.value>p.value?"text-red-600":"text-green-600"])},c(v.value)+" days ",3)]),s(a).leave_type!=="emergency"&&v.value>p.value?(n(),l("div",_e," ⚠️ You don't have sufficient leave balance for this request. ")):u("",!0)])):u("",!0),e("div",null,[o(g,{for:"reason",value:"Reason for Leave"}),k(e("textarea",{id:"reason","onUpdate:modelValue":t[3]||(t[3]=i=>s(a).reason=i),rows:"4",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Please provide a detailed reason for your leave request...",required:""},null,512),[[T,s(a).reason]]),o(f,{message:s(a).errors.reason,class:"mt-2"},null,8,["message"])]),!h.value&&s(a).start_date&&s(a).end_date?(n(),l("div",be,[e("div",we,[t[19]||(t[19]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",he,[t[18]||(t[18]=e("h3",{class:"text-sm font-medium text-red-800"},"Invalid Date Selection",-1)),e("div",De,[s(a).leave_type==="annual"?(n(),l("p",ke,"Annual leave can only be applied 30 days from current date onwards.")):s(a).leave_type==="emergency"?(n(),l("p",Be,"Emergency leave can only be applied from today onwards.")):(n(),l("p",Le,"Please ensure end date is not before start date."))])])])])):u("",!0),e("div",Me,[o($,{href:r.route("employee.leave.index")},{default:y(()=>t[20]||(t[20]=[B(" Cancel ")])),_:1},8,["href"]),o(U,{disabled:s(a).processing||!b.value||!h.value||s(a).leave_type!=="emergency"&&v.value>p.value},{default:y(()=>[s(a).processing?(n(),l("span",Se,"Submitting...")):(n(),l("span",Ae,"Submit Leave Request"))]),_:1},8,["disabled"])])],32)])])])])])])]),_:1})],64))}};export{$e as default};
